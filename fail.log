

  /home/g/playground/rabbits-engine/tests/GameEngine.test.js
    NPC transitions integration
for  { action: 'idle',
  duration: 40,
  next: [Function: next],
  start: 1475556344828,
  id: 'ea778dfc-0f6e-4695-a0fc-72de6422053c',
  owner: 1 }
{ x: 2, z: 2 } ' on ' { action: 'idle',
  duration: 40,
  next: [Function: next],
  start: 1475556344828,
  id: 'ea778dfc-0f6e-4695-a0fc-72de6422053c',
  owner: 1 } 'next ' { character: 1,
  type: 'walk',
  direction: { x: 20, z: 20 },
  owner: 1,
  action: 'walk',
  next: [Function: next],
  start: 1475556344925,
  id: 'e93a0293-c429-4606-855e-18ccce62c13f' }
adding  1
for  { action: 'idle',
  duration: 40,
  next: [Function: next],
  start: 1475556344829,
  id: 'f3eb59d3-16bf-41fd-a3a7-6a789aea68d1',
  owner: 2 }
2 'next state' null
WAS THE SAME AGAIN!!!!
new State for reals { character: 1,
  type: 'walk',
  direction: { x: 20, z: 20 },
  owner: 1,
  action: 'walk',
  next: [Function: next],
  start: 1475556344925,
  id: 'e93a0293-c429-4606-855e-18ccce62c13f' }
DO WALK 1 { x: 20, z: 20 }
on flee on sight { action: 'idle',
  duration: 40,
  next: [Function: next],
  start: 1475556344829,
  id: 'f3eb59d3-16bf-41fd-a3a7-6a789aea68d1',
  owner: 2 } { action: 'walk',
  character: 1,
  result: 'collision',
  position: { x: 2.585786437626905, z: 2.585786437626905 },
  duration: 100,
  type: 'characterUpdate',
  timestamp: 1475556344925 }
2 'for event' { action: 'walk',
  character: 1,
  result: 'collision',
  position: { x: 2.585786437626905, z: 2.585786437626905 },
  duration: 100,
  type: 'characterUpdate',
  timestamp: 1475556344925 } ' -> ' { action: 'walk',
  duration: 40,
  next: [Function: next],
  start: 1475556344860,
  id: 'e89198a8-3c37-4f17-bcca-0620b0a9637c',
  owner: 2,
  direction: { x: 21.65685424949238, z: 21.65685424949238 } }
EVENT { action: 'walk',
  character: 1,
  result: 'collision',
  position: { x: 2.585786437626905, z: 2.585786437626905 },
  duration: 100,
  type: 'characterUpdate',
  timestamp: 1475556344925 }
for  { character: 1,
  type: 'walk',
  direction: { x: 20, z: 20 },
  owner: 1,
  action: 'walk',
  next: [Function: next],
  start: 1475556344925,
  id: 'e93a0293-c429-4606-855e-18ccce62c13f' }
1 'next state' null
{ x: 2.585786437626905, z: 2.585786437626905 } ' on ' { character: 1,
  type: 'walk',
  direction: { x: 20, z: 20 },
  owner: 1,
  action: 'walk',
  next: [Function: next],
  start: 1475556344925,
  id: 'e93a0293-c429-4606-855e-18ccce62c13f' } 'next ' { character: 1,
  type: 'walk',
  direction: { x: 20, z: 20 },
  owner: 1,
  action: 'walk',
  next: [Function: next],
  start: 1475556344862,
  id: '65c5748f-67f5-4d69-b11e-ef4737a3cefa' }
adding  1
for  { action: 'idle',
  duration: 40,
  next: [Function: next],
  start: 1475556344829,
  id: 'f3eb59d3-16bf-41fd-a3a7-6a789aea68d1',
  owner: 2 }
2 'next state' { action: 'walk',
  duration: 40,
  next: [Function: next],
  start: 1475556344860,
  id: 'e89198a8-3c37-4f17-bcca-0620b0a9637c',
  owner: 2,
  direction: { x: 21.65685424949238, z: 21.65685424949238 } }
{ x: 4, z: 4 } ' on ' { action: 'idle',
  duration: 40,
  next: [Function: next],
  start: 1475556344829,
  id: 'f3eb59d3-16bf-41fd-a3a7-6a789aea68d1',
  owner: 2 } 'next ' { action: 'walk',
  duration: 40,
  next: [Function: next],
  start: 1475556345025,
  id: 'e89198a8-3c37-4f17-bcca-0620b0a9637c',
  owner: 2,
  direction: { x: 21.65685424949238, z: 21.65685424949238 } }
adding  2
new State for reals { character: 1,
  type: 'walk',
  direction: { x: 20, z: 20 },
  owner: 1,
  action: 'walk',
  next: [Function: next],
  start: 1475556344862,
  id: '65c5748f-67f5-4d69-b11e-ef4737a3cefa' }
DO WALK 1 { x: 20, z: 20 }
new State for reals { action: 'walk',
  duration: 40,
  next: [Function: next],
  start: 1475556345025,
  id: 'e89198a8-3c37-4f17-bcca-0620b0a9637c',
  owner: 2,
  direction: { x: 21.65685424949238, z: 21.65685424949238 } }
DO WALK 2 { x: 21.65685424949238, z: 21.65685424949238 }
on flee on sight { action: 'walk',
  duration: 40,
  next: [Function: next],
  start: 1475556345025,
  id: 'e89198a8-3c37-4f17-bcca-0620b0a9637c',
  owner: 2,
  direction: { x: 21.65685424949238, z: 21.65685424949238 } } { action: 'walk',
  character: 1,
  result: 'collision',
  position: { x: 2.585786437626905, z: 2.585786437626905 },
  duration: 100,
  type: 'characterUpdate',
  timestamp: 1475556345025 }
2 'for event' { action: 'walk',
  character: 1,
  result: 'collision',
  position: { x: 2.585786437626905, z: 2.585786437626905 },
  duration: 100,
  type: 'characterUpdate',
  timestamp: 1475556345025 } ' -> ' { action: 'walk',
  duration: 40,
  next: [Function: next],
  start: 1475556344869,
  id: 'c111eaac-00d4-49fa-967f-1f5913e763c4',
  owner: 2,
  direction: { x: 44.2842712474619, z: 44.2842712474619 } }
EVENT { action: 'walk',
  character: 1,
  result: 'collision',
  position: { x: 2.585786437626905, z: 2.585786437626905 },
  duration: 100,
  type: 'characterUpdate',
  timestamp: 1475556345025 }
for  { character: 1,
  type: 'walk',
  direction: { x: 20, z: 20 },
  owner: 1,
  action: 'walk',
  next: [Function: next],
  start: 1475556345025,
  id: '65c5748f-67f5-4d69-b11e-ef4737a3cefa' }
1 'next state' null
{ x: 2.585786437626905, z: 2.585786437626905 } ' on ' { character: 1,
  type: 'walk',
  direction: { x: 20, z: 20 },
  owner: 1,
  action: 'walk',
  next: [Function: next],
  start: 1475556345025,
  id: '65c5748f-67f5-4d69-b11e-ef4737a3cefa' } 'next ' { character: 1,
  type: 'walk',
  direction: { x: 20, z: 20 },
  owner: 1,
  action: 'walk',
  next: [Function: next],
  start: 1475556344870,
  id: 'ba1f9f15-1c29-40b9-8827-f6f600e8ac3b' }
adding  1
for  { action: 'walk',
  duration: 40,
  next: [Function: next],
  start: 1475556345025,
  id: 'e89198a8-3c37-4f17-bcca-0620b0a9637c',
  owner: 2,
  direction: { x: 21.65685424949238, z: 21.65685424949238 } }
2 'next state' { action: 'walk',
  duration: 40,
  next: [Function: next],
  start: 1475556344869,
  id: 'c111eaac-00d4-49fa-967f-1f5913e763c4',
  owner: 2,
  direction: { x: 44.2842712474619, z: 44.2842712474619 } }
{ x: 6.82842712474619, z: 6.82842712474619 } ' on ' { action: 'walk',
  duration: 40,
  next: [Function: next],
  start: 1475556345025,
  id: 'e89198a8-3c37-4f17-bcca-0620b0a9637c',
  owner: 2,
  direction: { x: 21.65685424949238, z: 21.65685424949238 } } 'next ' { action: 'walk',
  duration: 40,
  next: [Function: next],
  start: 1475556345125,
  id: 'c111eaac-00d4-49fa-967f-1f5913e763c4',
  owner: 2,
  direction: { x: 44.2842712474619, z: 44.2842712474619 } }
adding  2
new State for reals { character: 1,
  type: 'walk',
  direction: { x: 20, z: 20 },
  owner: 1,
  action: 'walk',
  next: [Function: next],
  start: 1475556344870,
  id: 'ba1f9f15-1c29-40b9-8827-f6f600e8ac3b' }
DO WALK 1 { x: 20, z: 20 }
new State for reals { action: 'walk',
  duration: 40,
  next: [Function: next],
  start: 1475556345125,
  id: 'c111eaac-00d4-49fa-967f-1f5913e763c4',
  owner: 2,
  direction: { x: 44.2842712474619, z: 44.2842712474619 } }
DO WALK 2 { x: 44.2842712474619, z: 44.2842712474619 }
on flee on sight { action: 'walk',
  duration: 40,
  next: [Function: next],
  start: 1475556345125,
  id: 'c111eaac-00d4-49fa-967f-1f5913e763c4',
  owner: 2,
  direction: { x: 44.2842712474619, z: 44.2842712474619 } } { action: 'walk',
  character: 2,
  result: 'walk',
  position: { x: 6.82842712474619, z: 6.82842712474619 },
  duration: 100,
  type: 'characterUpdate',
  timestamp: 1475556345025 }
2 'for event' { action: 'walk',
  character: 2,
  result: 'walk',
  position: { x: 6.82842712474619, z: 6.82842712474619 },
  duration: 100,
  type: 'characterUpdate',
  timestamp: 1475556345025 } ' -> ' null
EVENT { action: 'walk',
  character: 2,
  result: 'walk',
  position: { x: 6.82842712474619, z: 6.82842712474619 },
  duration: 100,
  type: 'characterUpdate',
  timestamp: 1475556345025 }
on flee on sight { action: 'walk',
  duration: 40,
  next: [Function: next],
  start: 1475556345125,
  id: 'c111eaac-00d4-49fa-967f-1f5913e763c4',
  owner: 2,
  direction: { x: 44.2842712474619, z: 44.2842712474619 } } { action: 'walk',
  character: 1,
  result: 'collision',
  position: { x: 5.414213562373095, z: 5.414213562373095 },
  duration: 100,
  type: 'characterUpdate',
  timestamp: 1475556345125 }
2 'for event' { action: 'walk',
  character: 1,
  result: 'collision',
  position: { x: 5.414213562373095, z: 5.414213562373095 },
  duration: 100,
  type: 'characterUpdate',
  timestamp: 1475556345125 } ' -> ' { action: 'walk',
  duration: 40,
  next: [Function: next],
  start: 1475556344875,
  id: '56f74706-61d7-4fe5-b4e4-595e385dc8f3',
  owner: 2,
  direction: { x: 55.597979746446654, z: 55.597979746446654 } }
on flee on sight { action: 'walk',
  duration: 40,
  next: [Function: next],
  start: 1475556345125,
  id: 'c111eaac-00d4-49fa-967f-1f5913e763c4',
  owner: 2,
  direction: { x: 44.2842712474619, z: 44.2842712474619 } } { action: 'walk',
  character: 2,
  result: 'walk',
  position: { x: 9.65685424949238, z: 9.65685424949238 },
  duration: 100,
  type: 'characterUpdate',
  timestamp: 1475556345125 }
2 'for event' { action: 'walk',
  character: 2,
  result: 'walk',
  position: { x: 9.65685424949238, z: 9.65685424949238 },
  duration: 100,
  type: 'characterUpdate',
  timestamp: 1475556345125 } ' -> ' null
      âœ“ Archer should flee for walking axeGuy (53ms)


  1 passing (79ms)

